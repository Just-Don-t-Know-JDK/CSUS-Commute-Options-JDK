<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Google Map</title>

    <style>
      /*Setting the size of the div element that contains the map */
      #map {
        /*Height of map */
        height: 400px;
        /*Width of map */
        width: 100%;
      }
    </style>

  <script>
    // Display the map
    let map, infoWindow;
    function initMap() {
      // The location of Sacramento State
      const sacState = { lat: 38.56131, lng: -121.42412 };
      // The map, centered at sacState
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: sacState,
      });
    };
    //Functions to calculate distance
    $(function() {
      // Adding input listener
      google.maps.event.addDomListener(window, 'load', function() {
        var from_places = new google.maps.places.Autocomplete(document.getElementById('from_places'));
        
        google.maps.event.addListener(from_places, 'place_changed', function () {
          var from_place = from_places.getPlace();
          var from_address = from_place.formatted_address;
          $('#origin').val(from_address);
        });

      });
      // Calculate distance
      function calculateDistance() {
        var origin = $('#origin').val();
        var destination = 6000+J+St+Sacramento+ON;
        var service = new google.maps.DistanceMatrixService();
        service.getDistanceMatrix(
          {
            origins: [origin],
            destinations: [destination],
            travelMode: google.maps.TravelMode.DRIVING,
            unitSystem: google.maps.UnitSystem.IMPERIAL,
            avoidHighways: false,
            avoidTolls: false
          }, callback);
      }
      // Get distance results
      function callback(reponse, status) {
        if (status != google.maps.DistanceMatrixStatus.OK) {
          $('result').html(err);
        } else {
          var origin = response.originAddresses[0];
          var destination = reponse.destinationAddress[0];
          if (response.rows[0].elements[0].status === "ZERO_RESULTS") {
            $('#result').html("No roads between " + origin + " and " + destination);
          } else {
            var distance = response.rows[0].elements[0].distance;
            var duration = response.rows[0].elements[0].duration;
            console.log(response.rows[0].elements[0].distance);
            var distance_in_kilo = distance.value / 1000; // the kilom
            var distance_in_mile = distance.value / 1609.34; // the mile
            var duration_text = duration.text;
            var duration_value = duration.value;
            $('#in_mile').text(distance_in_mile.toFixed(2));
            $('#in_kilo').text(distance_in_kilo.toFixed(2));
            $('#duration_text').text(duration_text);
            $('#duration_value').text(duration_value);
            $('#from').text(origin);
            $('#to').text(destination);
          }
        }
      }
      // Print results on submit the form
      $('#distance_form').submit(function(e){
        e.preventDefault();
        calculateDistance();
      });

    });
</script>

  </head>

  <body>

    <h1>My Google Map</h1>
  
    <div id="map"></div>

    <br><br>

    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <form id="distance_form">
            <div class="form-group">
              <label>Address: </label> 
              <input class="form-control" id="from_places" placeholder="Enter a location"/> 
              <input id="origin" name="origin" required="" type="hidden"/>
              <input class="btn btn-primary" type="submit" value="Calculate"/>
            </div>
          </form>
          <div id="result">
            <ul class="list-group">
              <li class="list-group-item d-flex justify-content-between align-items-center">Distance In Mile :</li>
	            <li class="list-group-item d-flex justify-content-between align-items-center">Distance is Kilo:</li>
	            <li class="list-group-item d-flex justify-content-between align-items-center">IN TEXT:</li>
	            <li class="list-group-item d-flex justify-content-between align-items-center">IN MINUTES:</li>
	            <li class="list-group-item d-flex justify-content-between align-items-center">FROM:</li>
	            <li class="list-group-item d-flex justify-content-between align-items-center">TO:</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC0snFsj6zf8NZ1vXHyQidrIqwHEG_a10c&callback=initMap&libraries=&v=weekly" defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" id="bootstrap-css" rel="stylesheet" />

  </body>

</html>